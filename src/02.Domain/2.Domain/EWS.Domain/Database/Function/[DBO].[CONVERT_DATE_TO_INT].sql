CREATE OR ALTER FUNCTION [DBO].[CONVERT_DATE_TO_INT] (@DATE DATE)
    RETURNS INT
AS
BEGIN
    DECLARE @V INT

    SET @V = YEAR(@DATE) * 10000 + MONTH(@DATE) * 100 + DAY(@DATE)

    RETURN @V
END